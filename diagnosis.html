<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Диагноз</title>

<style>
body { font-family: Arial; margin: 40px; }
.entry { border-bottom: 1px solid #ddd; padding: 15px 0; }
audio { width: 300px; }
</style>
</head>

<body>

<h1 id="title"></h1>
<p id="stats"></p>

<div id="list"></div>

<script>
const params = new URLSearchParams(window.location.search);
const diagnosis = params.get('d');

document.getElementById('title').innerText = diagnosis;

fetch('metadata.json')
  .then(r => r.json())
  .then(data => {
    const items = data.filter(x => x.diagnosis === diagnosis);
    const list = document.getElementById('list');

    let totalDuration = 0;

    items.forEach(x => {
      totalDuration += x.duration;

      const div = document.createElement('div');
      div.className = 'entry';
      div.innerHTML = `
        <audio controls src="audio/${x.id}"></audio>
        <p>${x.text}</p>
        <small>${x.duration} сек</small>
      `;
      list.appendChild(div);
    });

    document.getElementById('stats').innerText =
      `Файлов: ${items.length}, общая длительность: ${totalDuration.toFixed(1)} сек`;
  });
</script>

</body>
</html>
